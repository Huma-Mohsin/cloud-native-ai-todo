# Evolution of Todo - Hackathon II Constitution

## Project Identity

**Project Name**: Evolution of Todo - Cloud-Native AI Todo Application
**Hackathon**: Panaversity Hackathon II - Spec-Driven Development
**Objective**: Master the art of building applications iterativelyâ€”from console app to cloud-native AI chatbot deployed on Kubernetes
**Development Paradigm**: Spec-Driven Development using Claude Code and Spec-Kit Plus
**Constraint**: Code must be generated by Claude Code; manual coding is prohibited. Refine specs until correct output is achieved.

---

## Core Principles

### I. Spec-Driven Development (NON-NEGOTIABLE)

**All development must follow the Spec-Driven Development methodology:**

- **Markdown Constitution and Spec Required**: Every feature of every phase must have a written Markdown specification before implementation
- **No Manual Coding**: Developers cannot write code manually. All code must be generated by Claude Code from specifications
- **Iterative Refinement**: If Claude Code generates incorrect output, refine the specification and regenerateâ€”do not manually fix code
- **Specification Hierarchy**:
  1. Constitution (this document) - Project-wide principles
  2. Feature Specs - What to build (user stories, acceptance criteria)
  3. API Specs - How APIs should work (endpoints, contracts)
  4. Database Specs - Data models and schemas
  5. UI Specs - Component and page specifications
- **Spec Storage**: All specifications reside in `/specs` directory, organized by type and feature
- **Spec Versioning**: Keep spec history in `/specs/history` to track evolution

### II. Progressive Evolution Architecture

**The project evolves through 5 distinct phases, each building on the previous:**

**Phase I: In-Memory Python Console App (100 points)**
- Technology: Python 3.13+, UV package manager
- Features: Basic Level only (Add, Delete, Update, View, Mark Complete)
- Storage: In-memory (no persistence)
- Interface: Command-line interface
- Due: December 7, 2025

**Phase II: Full-Stack Web Application (150 points)**
- Frontend: Next.js 16+ (App Router), TypeScript, Tailwind CSS
- Backend: Python FastAPI, SQLModel ORM
- Database: Neon Serverless PostgreSQL
- Authentication: Better Auth with JWT tokens
- Features: Basic Level as multi-user web app
- Due: December 14, 2025

**Phase III: AI-Powered Todo Chatbot (200 points)**
- Frontend: OpenAI ChatKit
- AI Framework: OpenAI Agents SDK
- MCP Server: Official MCP SDK (Model Context Protocol)
- Features: Natural language task management via MCP tools
- Architecture: Stateless chat endpoint with database-persisted conversation state
- Due: December 21, 2025

**Phase IV: Local Kubernetes Deployment (250 points)**
- Containerization: Docker (Docker Desktop with Gordon AI)
- Orchestration: Kubernetes via Minikube
- Package Manager: Helm Charts
- AIOps: kubectl-ai, kagent for AI-assisted K8s operations
- Features: Containerized Phase III chatbot
- Due: January 4, 2026

**Phase V: Advanced Cloud Deployment (300 points)**
- Cloud Platform: DigitalOcean Kubernetes (DOKS) or Google Cloud (GKE) or Azure (AKS)
- Event Streaming: Kafka on Redpanda Cloud
- Distributed Runtime: Dapr (Pub/Sub, State, Bindings, Secrets, Service Invocation)
- Features: All Advanced Level features (Recurring Tasks, Due Dates, Reminders) + Intermediate Level (Priorities, Tags, Search, Filter, Sort)
- CI/CD: GitHub Actions
- Monitoring: Production-grade logging and observability
- Due: January 18, 2026

**Non-Negotiable Phase Rules:**
- Phases must be completed sequentially
- Each phase builds on previous phase's codebase
- No skipping phases
- Phase features cannot be downgraded in later phases

### III. Monorepo Structure (MANDATORY)

**Repository Organization:**

```
hackathon-todo/
â”œâ”€â”€ .spec-kit/                    # Spec-Kit configuration
â”‚   â””â”€â”€ config.yaml
â”œâ”€â”€ specs/                        # Spec-Kit managed specifications
â”‚   â”œâ”€â”€ overview.md               # Project overview
â”‚   â”œâ”€â”€ architecture.md           # System architecture
â”‚   â”œâ”€â”€ features/                 # Feature specifications
â”‚   â”‚   â”œâ”€â”€ task-crud.md
â”‚   â”‚   â”œâ”€â”€ authentication.md
â”‚   â”‚   â”œâ”€â”€ chatbot.md
â”‚   â”‚   â”œâ”€â”€ recurring-tasks.md
â”‚   â”‚   â””â”€â”€ reminders.md
â”‚   â”œâ”€â”€ api/                      # API specifications
â”‚   â”‚   â”œâ”€â”€ rest-endpoints.md
â”‚   â”‚   â””â”€â”€ mcp-tools.md
â”‚   â”œâ”€â”€ database/                 # Database specifications
â”‚   â”‚   â””â”€â”€ schema.md
â”‚   â””â”€â”€ ui/                       # UI specifications
â”‚       â”œâ”€â”€ components.md
â”‚       â””â”€â”€ pages.md
â”œâ”€â”€ history/
â”‚   â”œâ”€â”€ prompts/                  # Prompt History Records
â”‚   â”‚   â”œâ”€â”€ constitution/
â”‚   â”‚   â”œâ”€â”€ general/
â”‚   â”‚   â””â”€â”€ <feature-name>/
â”‚   â””â”€â”€ adr/                      # Architecture Decision Records
â”œâ”€â”€ .specify/                     # SpecKit Plus templates and scripts
â”‚   â”œâ”€â”€ memory/
â”‚   â”‚   â””â”€â”€ constitution.md       # This file
â”‚   â”œâ”€â”€ templates/
â”‚   â””â”€â”€ scripts/
â”œâ”€â”€ CLAUDE.md                     # Root Claude Code instructions
â”œâ”€â”€ frontend/                     # Next.js application (Phase II+)
â”‚   â”œâ”€â”€ CLAUDE.md
â”‚   â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ lib/
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ backend/                      # FastAPI application (Phase II+)
â”‚   â”œâ”€â”€ CLAUDE.md
â”‚   â”œâ”€â”€ main.py
â”‚   â”œâ”€â”€ models.py
â”‚   â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ mcp/                      # MCP server (Phase III+)
â”‚   â”œâ”€â”€ db.py
â”‚   â””â”€â”€ pyproject.toml
â”œâ”€â”€ console-app/                  # Python console app (Phase I)
â”‚   â”œâ”€â”€ src/
â”‚   â””â”€â”€ pyproject.toml
â”œâ”€â”€ k8s/                          # Kubernetes manifests (Phase IV+)
â”‚   â”œâ”€â”€ charts/                   # Helm charts
â”‚   â””â”€â”€ dapr-components/          # Dapr components (Phase V)
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ README.md
```

**Rationale**: Single context allows Claude Code to see entire project and make cross-cutting changes efficiently.

### IV. Feature Levels and Progressive Implementation

**Basic Level Features (Core Essentials) - Required in ALL Phases:**
1. **Add Task** - Create new todo items with title and description
2. **Delete Task** - Remove tasks from the list
3. **Update Task** - Modify existing task details
4. **View Task List** - Display all tasks with status
5. **Mark as Complete** - Toggle task completion status

**Intermediate Level Features - Required Phase V Only:**
1. **Priorities & Tags/Categories** - Assign levels (high/medium/low) or labels (work/home)
2. **Search & Filter** - Search by keyword; filter by status, priority, or date
3. **Sort Tasks** - Reorder by due date, priority, or alphabetically

**Advanced Level Features - Required Phase V Only:**
1. **Recurring Tasks** - Auto-reschedule repeating tasks (e.g., "weekly meeting")
2. **Due Dates & Time Reminders** - Set deadlines with date/time pickers; browser notifications

**Feature Implementation Rules:**
- Basic Level features must work identically across all phases (only interface changes)
- Features cannot be removed in later phases
- Advanced features build on Basic features, never replace them

### V. Technology Stack Standards

**Phase I (Console App):**
- Language: Python 3.13+
- Package Manager: UV (mandatory)
- Testing: pytest
- Code Quality: ruff (linter), mypy (type checking)

**Phase II-V (Full Stack):**

**Frontend:**
- Framework: Next.js 16+ with App Router (not Pages Router)
- Language: TypeScript (strict mode enabled)
- Styling: Tailwind CSS (no inline styles, no CSS-in-JS)
- Components: React Server Components by default; Client Components only when interactivity required
- API Client: Centralized in `/lib/api.ts`
- Authentication: Better Auth with JWT tokens

**Backend:**
- Framework: FastAPI (Python)
- ORM: SQLModel (mandatory for database operations)
- Database: Neon Serverless PostgreSQL
- Validation: Pydantic models for all request/response
- Error Handling: HTTPException with proper status codes
- API Convention: All routes under `/api/`

**Phase III+ (AI/Chatbot):**
- Chatbot UI: OpenAI ChatKit
- AI Framework: OpenAI Agents SDK (agent + runner pattern)
- MCP Server: Official MCP SDK (Python)
- Conversation State: Database-persisted (stateless server required)

**Phase IV+ (Cloud-Native):**
- Containerization: Docker with Docker AI Agent (Gordon)
- Orchestration: Kubernetes (Minikube local, DOKS/GKE/AKS cloud)
- Package Manager: Helm Charts
- AIOps: kubectl-ai and kagent

**Phase V (Event-Driven):**
- Event Streaming: Kafka on Redpanda Cloud
- Distributed Runtime: Dapr with components:
  - Pub/Sub (Kafka abstraction)
  - State Management (PostgreSQL state store)
  - Service Invocation (service discovery)
  - Bindings (cron triggers for reminders)
  - Secrets Management (Kubernetes secrets)

**Technology Substitution Policy:**
- Core stack is non-negotiable and cannot be changed
- Additional complementary tools/libraries are permitted
- Any substitution requires ADR (Architecture Decision Record)

### VI. API Design Standards

**RESTful API Conventions (Phase II+):**

**Base Structure:**
- Base URL Development: `http://localhost:8000`
- Base URL Production: `https://api.[your-domain].com`
- All routes prefixed: `/api/`
- User-scoped routes: `/api/{user_id}/...`

**Authentication:**
- Method: JWT tokens via Better Auth
- Header: `Authorization: Bearer <token>`
- All endpoints require valid JWT (401 Unauthorized if missing/invalid)
- User ID in JWT must match `{user_id}` in URL path

**Standard Endpoints:**

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/api/{user_id}/tasks` | List all tasks for user |
| POST | `/api/{user_id}/tasks` | Create new task |
| GET | `/api/{user_id}/tasks/{id}` | Get task details |
| PUT | `/api/{user_id}/tasks/{id}` | Update task |
| DELETE | `/api/{user_id}/tasks/{id}` | Delete task |
| PATCH | `/api/{user_id}/tasks/{id}/complete` | Toggle completion |

**Request/Response Standards:**
- Content-Type: `application/json`
- Validation: Pydantic models for all inputs/outputs
- Error Format: `{"error": "message", "detail": {...}}`
- Success Format: Return affected resource(s)

**MCP Tools Specification (Phase III+):**

All MCP tools must:
- Accept `user_id` as first parameter (string, required)
- Return structured JSON: `{task_id, status, title, ...}`
- Be stateless (no in-memory state)
- Interact with database for all state
- Follow naming: `add_task`, `list_tasks`, `complete_task`, `delete_task`, `update_task`

**Chat API (Phase III+):**
- Endpoint: `POST /api/{user_id}/chat`
- Request: `{conversation_id?: number, message: string}`
- Response: `{conversation_id: number, response: string, tool_calls: array}`
- Behavior: Stateless request cycleâ€”fetch history, process, store, respond

### VII. Database Standards

**Schema Design Principles:**
- All tables require: `id` (primary key), `created_at`, `updated_at`
- User isolation: All user data tables include `user_id` foreign key
- Indexes: Add on all foreign keys and frequently queried fields
- Migrations: All schema changes via migration scripts (tracked in version control)

**Core Tables:**

**users** (managed by Better Auth):
- `id`: string (primary key)
- `email`: string (unique, not null)
- `name`: string
- `created_at`: timestamp

**tasks**:
- `id`: integer (primary key, auto-increment)
- `user_id`: string (foreign key -> users.id, indexed)
- `title`: string (not null, max 200 chars)
- `description`: text (nullable, max 1000 chars)
- `completed`: boolean (default false, indexed)
- `priority`: string (nullable, enum: high/medium/low) - Phase V
- `tags`: array/string (nullable) - Phase V
- `due_date`: timestamp (nullable) - Phase V
- `recurring_pattern`: string (nullable, e.g., "weekly", "daily") - Phase V
- `created_at`: timestamp
- `updated_at`: timestamp

**conversations** (Phase III+):
- `id`: integer (primary key, auto-increment)
- `user_id`: string (foreign key -> users.id, indexed)
- `created_at`: timestamp
- `updated_at`: timestamp

**messages** (Phase III+):
- `id`: integer (primary key, auto-increment)
- `conversation_id`: integer (foreign key -> conversations.id, indexed)
- `user_id`: string (foreign key -> users.id, indexed)
- `role`: string (enum: "user", "assistant")
- `content`: text (not null)
- `created_at`: timestamp

**Connection Management:**
- Use connection pooling
- Environment variable: `DATABASE_URL`
- Never hardcode credentials
- SQLModel for all database operations (no raw SQL except complex queries)

### VIII. Authentication & Security

**Better Auth + JWT Integration:**

**Frontend (Next.js):**
- Better Auth handles user signup/signin
- JWT plugin enabled to issue tokens
- Token stored securely (httpOnly cookies or secure localStorage)
- All API requests include: `Authorization: Bearer <token>`

**Backend (FastAPI):**
- JWT middleware verifies token signature using shared secret
- Extract `user_id` from token
- Validate `user_id` matches URL path parameter
- Return 401 Unauthorized if token invalid/missing
- Return 403 Forbidden if user_id mismatch

**Shared Secret:**
- Environment variable: `BETTER_AUTH_SECRET`
- Must be identical in frontend and backend
- Minimum 32 characters, cryptographically random
- Never commit to version control

**Security Requirements:**
- No secrets in code or specs
- All secrets in `.env` (gitignored)
- Validate all user inputs (SQL injection, XSS prevention)
- Implement rate limiting on authentication endpoints
- HTTPS required in production
- CORS configured properly (no `*` in production)

**Data Isolation:**
- Every query filters by authenticated user's ID
- Users can only access their own tasks
- Users can only access their own conversations/messages
- Database-level foreign key constraints enforced

### IX. Testing Standards (NON-NEGOTIABLE)

**Test-Driven Development (TDD) Required:**
- Write tests BEFORE implementation
- Red-Green-Refactor cycle:
  1. **Red**: Write failing test
  2. **Green**: Implement minimal code to pass
  3. **Refactor**: Improve code while keeping tests green

**Test Coverage Requirements:**

**Phase I (Console App):**
- Unit tests for all CRUD operations
- Edge cases: empty lists, invalid IDs, duplicate operations
- Minimum coverage: 80%

**Phase II+ (Full Stack):**
- **Backend**:
  - Unit tests for all MCP tools (Phase III+)
  - API endpoint tests (all HTTP methods)
  - Authentication tests (valid/invalid tokens)
  - Database tests (SQLModel operations)
  - Minimum coverage: 80%

- **Frontend**:
  - Component tests (React Testing Library)
  - Integration tests (API client)
  - E2E tests for critical flows (optional but recommended)
  - Minimum coverage: 70%

**Phase IV+ (Cloud-Native):**
- Container health checks
- Helm chart validation
- Kubernetes manifest linting

**Phase V (Event-Driven):**
- Kafka producer/consumer tests
- Dapr component integration tests
- Event flow end-to-end tests

**Testing Tools:**
- Python: pytest, pytest-asyncio, httpx (for FastAPI testing)
- JavaScript: Vitest/Jest, React Testing Library
- E2E: Playwright (optional)

**CI/CD Integration:**
- All tests run on every commit (GitHub Actions)
- PRs blocked if tests fail
- No deployments without passing tests

### X. Code Quality Standards

**Python (Backend & Console App):**
- Formatter: `ruff format` (enforced in CI)
- Linter: `ruff check` (no warnings allowed)
- Type Checker: `mypy --strict`
- Import Sorting: `ruff` (isort rules)
- Docstrings: Required for all public functions/classes (Google style)
- Line Length: 100 characters max

**TypeScript (Frontend):**
- Compiler: `strict: true` in tsconfig.json
- Linter: ESLint with Next.js config
- Formatter: Prettier (enforced in CI)
- No `any` types (use `unknown` if necessary)
- Props: Typed interfaces for all components
- Line Length: 100 characters max

**General Code Standards:**
- No commented-out code (use version control)
- No TODOs without linked issues
- No magic numbers (use named constants)
- Functions: Single responsibility, max 50 lines
- Files: Max 300 lines (split if larger)
- Naming: Descriptive, no abbreviations except common (id, url, api)

**Git Commit Standards:**
- Format: `<type>(<scope>): <description>`
- Types: feat, fix, docs, refactor, test, chore
- Description: Imperative mood, lowercase, no period
- Body: Explain "why" not "what"
- Footer: Reference issues/PRs
- Co-authored-by: Include Claude attribution:
  ```
  ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

  Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>
  ```

### XI. Event-Driven Architecture (Phase V)

**Kafka Topics:**

| Topic | Producer | Consumer | Purpose |
|-------|----------|----------|---------|
| `task-events` | Chat API (MCP Tools) | Recurring Task Service, Audit Service | All task CRUD operations |
| `reminders` | Chat API (when due date set) | Notification Service | Scheduled reminder triggers |
| `task-updates` | Chat API | WebSocket Service | Real-time client sync |

**Event Schema Standards:**

**task-events:**
```json
{
  "event_type": "created|updated|completed|deleted",
  "task_id": 123,
  "task_data": {...},
  "user_id": "user123",
  "timestamp": "2025-12-31T10:00:00Z"
}
```

**reminders:**
```json
{
  "task_id": 123,
  "title": "Task title",
  "due_at": "2025-12-31T15:00:00Z",
  "remind_at": "2025-12-31T14:00:00Z",
  "user_id": "user123"
}
```

**Kafka Service Requirements:**
- **Cloud**: Redpanda Cloud Serverless (free tier) - Kafka-compatible
- **Local**: Redpanda Docker container
- **Client Library**: kafka-python or aiokafka
- **Configuration**: Bootstrap servers and credentials in environment variables

**Why Kafka:**
- Decoupled notification service
- Async processing for recurring tasks (no blocking)
- Complete audit trail of all operations
- Real-time multi-client synchronization
- Scalable microservices architecture

### XII. Dapr Integration Standards (Phase V)

**Dapr Building Blocks Usage:**

1. **Pub/Sub (Kafka Abstraction)**:
   - Publish events via Dapr HTTP API (no kafka-python in app code)
   - Component: `pubsub.kafka`
   - Benefits: Swap Kafka for RabbitMQ via config change

2. **State Management**:
   - Store conversation state via Dapr State API
   - Component: `state.postgresql`
   - Benefits: Centralized state, no direct DB calls for state

3. **Service Invocation**:
   - Frontend â†’ Backend via Dapr sidecar
   - Built-in service discovery, retries, mTLS
   - Benefits: No hardcoded service URLs

4. **Bindings (Cron Triggers)**:
   - Schedule reminder checks
   - Component: `bindings.cron`
   - Dapr calls backend endpoint on schedule

5. **Secrets Management**:
   - Access secrets via Dapr Secrets API
   - Component: `secretstores.kubernetes`
   - Benefits: No secrets in code/env files

**Dapr Architecture:**
- Every pod runs with Dapr sidecar
- App communicates with Dapr via `http://localhost:3500`
- Dapr handles all infrastructure interactions
- Components defined in YAML (K8s manifests)

**Local vs Cloud Dapr:**
- **Minikube**: Dapr with Pub/Sub and basic state management
- **DOKS/GKE/AKS**: Full Dapr (all 5 building blocks)

### XIII. Deployment & DevOps Standards

**Phase IV (Local Kubernetes):**

**Docker:**
- Multi-stage builds (minimize image size)
- Docker AI Agent (Gordon) for intelligent operations
- Health checks in Dockerfile
- Non-root user
- `.dockerignore` to exclude unnecessary files

**Minikube:**
- Local Kubernetes cluster
- kubectl-ai for AI-assisted K8s operations
- kagent for cluster analysis and optimization

**Helm Charts:**
- Chart per service (frontend, backend)
- Values files for environment-specific config
- Templates for Deployment, Service, Ingress, ConfigMap, Secret
- Version pinning in Chart.yaml

**Phase V (Cloud Deployment):**

**Cloud Platform:**
- Primary: DigitalOcean Kubernetes (DOKS) - $200 credit for 60 days
- Alternatives: Google Cloud (GKE) - $300 credit for 90 days, Azure (AKS) - $200 credit for 30 days

**CI/CD Pipeline (GitHub Actions):**
```yaml
Workflow:
1. Trigger: Push to main or PR
2. Lint & Type Check
3. Run Tests
4. Build Docker Images
5. Push to Registry
6. Deploy to Staging (auto)
7. Deploy to Production (manual approval)
```

**Monitoring & Observability:**
- Structured logging (JSON format)
- Log levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
- Metrics: Request count, latency, error rate
- Tracing: Distributed tracing with correlation IDs
- Health endpoints: `/health` (liveness), `/ready` (readiness)

**Environment Management:**
- Development: Local (Minikube)
- Staging: Cloud cluster (namespace: staging)
- Production: Cloud cluster (namespace: production)
- Config via ConfigMaps/Secrets
- Never share secrets across environments

### XIV. Natural Language Processing (Phase III+)

**Chatbot Behavior Specification:**

The AI agent must understand and execute these natural language patterns:

| User Input | Agent Action | MCP Tool |
|------------|--------------|----------|
| "Add a task to buy groceries" | Create task with title "Buy groceries" | `add_task` |
| "Show me all my tasks" | List all tasks (status: all) | `list_tasks` |
| "What's pending?" | List pending tasks (status: pending) | `list_tasks` |
| "Mark task 3 as complete" | Mark task ID 3 complete | `complete_task` |
| "Delete the meeting task" | Search for "meeting" then delete | `list_tasks` + `delete_task` |
| "Change task 1 to 'Call mom tonight'" | Update task 1 title | `update_task` |
| "I need to remember to pay bills" | Create task "Pay bills" | `add_task` |
| "What have I completed?" | List completed tasks (status: completed) | `list_tasks` |

**Agent Requirements:**
- Confirm actions with friendly response (e.g., "âœ“ Added task: Buy groceries")
- Handle ambiguity (e.g., "Which task did you mean?" if multiple matches)
- Gracefully handle errors (e.g., "I couldn't find that task")
- Support follow-up context (e.g., "Delete it" after viewing a task)
- Maintain conversation history via database

**OpenAI ChatKit Setup:**
- Domain allowlist required for hosted deployment
- Add production domain at: https://platform.openai.com/settings/organization/security/domain-allowlist
- Environment variable: `NEXT_PUBLIC_OPENAI_DOMAIN_KEY`
- Local development (`localhost`) works without domain key

### XV. Documentation Standards

**Required Documentation Files:**

1. **README.md** (Root):
   - Project overview
   - Technology stack
   - Setup instructions (prerequisites, installation, running)
   - Project structure
   - Links to phase-specific docs
   - Demo video link
   - License

2. **CLAUDE.md** (Root + Subfolders):
   - Root: Overall project structure, spec usage, development workflow
   - Frontend: Stack, patterns, component structure, API client usage
   - Backend: Stack, project structure, API conventions, database usage

3. **Specification Files** (`/specs`):
   - Feature specs: User stories, acceptance criteria
   - API specs: Endpoints, request/response formats, authentication
   - Database specs: Schema, indexes, migrations
   - UI specs: Components, pages, interactions

4. **Architecture Decision Records** (`/history/adr`):
   - Significant decisions documented
   - Format: Context, Decision, Consequences
   - Numbered sequentially (e.g., `001-use-fastapi.md`)

5. **Phase-Specific READMEs**:
   - Phase I: Console app usage
   - Phase II: Web app setup (frontend + backend)
   - Phase III: Chatbot setup (MCP server, OpenAI keys)
   - Phase IV: Kubernetes setup (Minikube, Helm)
   - Phase V: Cloud deployment (DOKS/GKE/AKS, Kafka, Dapr)

**Code Documentation:**
- All public APIs: Docstrings with parameters, returns, raises
- Complex algorithms: Inline comments explaining "why"
- TypeScript: JSDoc for exported functions
- Python: Google-style docstrings

### XVI. Submission Requirements

**Deliverables per Phase:**

1. **Public GitHub Repository**:
   - All source code
   - `/specs` folder with all specifications
   - `CLAUDE.md` with Claude Code instructions
   - `README.md` with setup instructions
   - Clear folder structure

2. **Deployed Application Links**:
   - Phase I: N/A (console app)
   - Phase II: Vercel frontend URL + Backend API URL
   - Phase III: Chatbot URL (frontend + backend)
   - Phase IV: Minikube setup instructions in README
   - Phase V: Production URL (DOKS/GKE/AKS)

3. **Demo Video** (Maximum 90 seconds):
   - Demonstrate all implemented features
   - Show spec-driven development workflow
   - **Important**: Judges only watch first 90 seconds
   - Can use NotebookLM or screen recording
   - Upload to YouTube/Vimeo (unlisted is fine)

4. **WhatsApp Number**: For live presentation invitation

**Submission Form**: https://forms.gle/KMKEKaFUD6ZX4UtY8

**Submission Deadlines:**
- Phase I: December 7, 2025
- Phase II: December 14, 2025
- Phase III: December 21, 2025
- Phase IV: January 4, 2026
- Phase V: January 18, 2026

**Submission can be done before deadline** - submit each phase as soon as ready.

### XVII. Bonus Features (Optional)

**Additional Points Available:**

| Bonus Feature | Points | Requirements |
|---------------|--------|--------------|
| Reusable Intelligence | +200 | Create and use reusable intelligence via Claude Code Subagents and Agent Skills |
| Cloud-Native Blueprints | +200 | Create and use Cloud-Native Blueprints via Agent Skills |
| Multi-language Support | +100 | Support Urdu in chatbot |
| Voice Commands | +200 | Add voice input for todo commands |

**Total Possible Bonus**: +700 points

**Bonus Implementation Rules:**
- Bonus features do not replace core requirements
- Bonus features must be documented in specs
- Bonus features must pass same quality standards as core features

### XVIII. Windows Development Requirements

**WSL 2 Mandatory for Windows Users:**

Windows users MUST use WSL 2 (Windows Subsystem for Linux):

```bash
# Install WSL 2
wsl --install

# Set WSL 2 as default
wsl --set-default-version 2

# Install Ubuntu
wsl --install -d Ubuntu-22.04
```

**Rationale:**
- Docker Desktop on Windows requires WSL 2
- Kubernetes tooling works better in Linux environment
- Shell scripts in `.specify/scripts/bash/` require bash
- Consistent development environment across team

**All development commands run inside WSL 2 Ubuntu terminal.**

### XIX. Performance Standards

**API Response Times:**
- Task CRUD operations: < 200ms (p95)
- Task list (< 100 items): < 300ms (p95)
- Chat endpoint: < 2s (p95) - includes AI processing
- Database queries: < 100ms (p95)

**Frontend Performance:**
- First Contentful Paint: < 1.5s
- Time to Interactive: < 3s
- Lighthouse Score: > 90

**Scalability Targets (Phase V):**
- Concurrent users: 100+ (Phase V production)
- Tasks per user: 10,000+
- Messages per conversation: 1,000+

**Resource Limits (Kubernetes):**
- Frontend pods: 256MB memory, 0.5 CPU
- Backend pods: 512MB memory, 1 CPU
- Horizontal Pod Autoscaling: Min 2, Max 10 replicas

### XX. Error Handling Standards

**HTTP Status Codes:**
- 200 OK: Successful GET
- 201 Created: Successful POST
- 204 No Content: Successful DELETE
- 400 Bad Request: Invalid input
- 401 Unauthorized: Missing/invalid token
- 403 Forbidden: User not authorized for resource
- 404 Not Found: Resource doesn't exist
- 422 Unprocessable Entity: Validation error
- 500 Internal Server Error: Server error

**Error Response Format:**
```json
{
  "error": "Brief error message",
  "detail": {
    "field": "Specific field error",
    "code": "ERROR_CODE"
  }
}
```

**Client-Side Error Handling:**
- Display user-friendly error messages
- Log errors to console (dev) or monitoring service (prod)
- Retry logic for transient failures (with exponential backoff)
- Graceful degradation when services unavailable

**Backend Error Handling:**
- Catch all exceptions
- Log with correlation ID
- Never expose stack traces to client in production
- Database errors: Rollback transaction, log, return 500

---

## Development Workflow

### Spec-Driven Development Process

**For Every Feature:**

1. **Write Specification** (`/specs/features/<feature-name>.md`):
   - User stories
   - Acceptance criteria
   - API contracts (if applicable)
   - Database changes (if applicable)
   - UI mockups (if applicable)

2. **Reference Spec in Claude Code**:
   - `@specs/features/<feature-name>.md implement this feature`

3. **Claude Code Generates Implementation**:
   - Backend code
   - Frontend code
   - Tests
   - Documentation

4. **Review Generated Code**:
   - Verify against acceptance criteria
   - Run tests
   - Check code quality (linting, type checking)

5. **If Incorrect**:
   - **DO NOT manually fix code**
   - Refine specification (add details, clarify requirements)
   - Re-run Claude Code with updated spec

6. **If Correct**:
   - Commit with proper message format
   - Update spec status to "implemented"
   - Move to next feature

### Prompt History Records (PHR)

**After every significant interaction with Claude Code, create a PHR:**

- **Location**: `history/prompts/<category>/`
- **Categories**:
  - `constitution/` - Constitution updates
  - `<feature-name>/` - Feature-specific work
  - `general/` - General queries, debugging

- **Template**: `.specify/templates/phr-template.prompt.md`

- **Required Fields**:
  - ID (sequential)
  - Title
  - Stage (constitution, spec, plan, tasks, red, green, refactor, explainer, misc, general)
  - Date
  - Prompt text (full user input, verbatim)
  - Response text (key assistant output)
  - Files changed
  - Tests run

### Architecture Decision Records (ADR)

**When to Create ADR:**

Test for significance (ALL must be true):
1. **Impact**: Long-term consequences? (framework, data model, API, security, platform)
2. **Alternatives**: Multiple viable options considered?
3. **Scope**: Cross-cutting and influences system design?

**Examples Requiring ADR:**
- Choosing FastAPI over Django
- JWT vs Session-based authentication
- Monorepo vs separate repos
- Redpanda Cloud vs self-hosted Kafka
- Dapr vs direct service communication

**ADR Process:**
1. Claude Code suggests: "ðŸ“‹ Architectural decision detected: [brief]. Document? Run `/sp.adr [title]`"
2. User approves: `/sp.adr use-fastapi-for-backend`
3. Claude Code creates ADR in `history/adr/`
4. ADR includes: Context, Decision, Consequences, Alternatives Considered

**ADR Template**: `.specify/templates/adr-template.md`

---

## Quality Gates

### Pre-Commit Checks

**Automated (Git Hooks):**
- Linting (ruff, ESLint)
- Type checking (mypy, tsc)
- Formatting (ruff format, Prettier)
- Unit tests (fast tests only)

### Pre-Push Checks

**Automated (Git Hooks):**
- Full test suite
- Build succeeds
- No TypeScript errors
- No Python type errors

### Pre-Merge Checks (CI/CD)

**GitHub Actions:**
- All tests pass
- Code coverage meets thresholds (80% backend, 70% frontend)
- Security scan (no critical vulnerabilities)
- Docker images build successfully
- Helm charts validate

### Phase Completion Checklist

**Before Submitting Each Phase:**

- [ ] All required features implemented and tested
- [ ] All specs written and up-to-date
- [ ] README updated with phase-specific instructions
- [ ] CLAUDE.md updated with new patterns/conventions
- [ ] All tests passing (CI green)
- [ ] Code quality checks passing (linting, type checking)
- [ ] Application deployed (Phase II+)
- [ ] Demo video recorded (< 90 seconds)
- [ ] GitHub repository public and accessible
- [ ] Submission form completed

---

## Governance

### Constitution Authority

**This constitution supersedes all other practices, conventions, and documentation.**

**Hierarchy:**
1. **Constitution** (this document) - Highest authority
2. **Architecture Decision Records** - Decisions made during development
3. **Feature Specifications** - What to build
4. **Code** - Implementation

**Conflict Resolution:**
- If code conflicts with spec, spec wins
- If spec conflicts with ADR, ADR wins
- If ADR conflicts with constitution, constitution wins

### Amendment Process

**Amendments to this constitution require:**
1. **Justification**: Clear rationale for change (document in ADR)
2. **Approval**: Explicit decision to amend
3. **Migration Plan**: Steps to update existing code/docs to comply
4. **Version Bump**: Update version number and last amended date

### Compliance Verification

**All code must comply with this constitution:**
- PRs reviewed against constitution principles
- Claude Code generates code following these standards
- CI/CD enforces technical standards (linting, testing, etc.)
- Complexity must be justified (via ADR)

### Continuous Improvement

**This constitution evolves with the project:**
- Lessons learned captured in ADRs
- New patterns added via amendment process
- Outdated practices deprecated explicitly
- Regular reviews (end of each phase)

---

## Appendix: Quick Reference

### Essential Commands

**Phase I (Console App):**
```bash
# Setup
uv venv
source .venv/bin/activate  # or .venv\Scripts\activate on Windows
uv pip install -e .

# Run
python -m todo_app

# Test
pytest
```

**Phase II+ (Full Stack):**
```bash
# Frontend
cd frontend
npm install
npm run dev  # http://localhost:3000

# Backend
cd backend
uv venv && source .venv/bin/activate
uv pip install -e .
uvicorn main:app --reload  # http://localhost:8000

# Both (with Docker)
docker-compose up
```

**Phase IV+ (Kubernetes):**
```bash
# Minikube
minikube start
kubectl-ai "deploy the todo frontend with 2 replicas"

# Helm
helm install todo-frontend ./k8s/charts/frontend
helm install todo-backend ./k8s/charts/backend

# Docker AI
docker ai "What can you do?"
docker ai "Build and run the backend service"
```

**Phase V (Dapr):**
```bash
# Initialize Dapr
dapr init -k

# Deploy components
kubectl apply -f k8s/dapr-components/

# Run with Dapr
dapr run --app-id backend --app-port 8000 -- uvicorn main:app
```

### Environment Variables Template

```bash
# .env (NEVER commit this file)

# Database
DATABASE_URL=postgresql://user:pass@host:5432/dbname

# Authentication
BETTER_AUTH_SECRET=your-32-char-secret-here

# OpenAI
OPENAI_API_KEY=sk-...
NEXT_PUBLIC_OPENAI_DOMAIN_KEY=your-domain-key

# Kafka (Redpanda Cloud)
KAFKA_BOOTSTRAP_SERVERS=your-cluster.cloud.redpanda.com:9092
KAFKA_SASL_USERNAME=your-username
KAFKA_SASL_PASSWORD=your-password

# Production
NODE_ENV=production
ENVIRONMENT=production
```

### Key File Paths

| File | Purpose |
|------|---------|
| `.specify/memory/constitution.md` | This document |
| `CLAUDE.md` | Claude Code instructions |
| `specs/overview.md` | Project overview |
| `specs/features/*.md` | Feature specifications |
| `specs/api/*.md` | API specifications |
| `specs/database/schema.md` | Database schema |
| `history/prompts/` | Prompt History Records |
| `history/adr/` | Architecture Decision Records |
| `README.md` | Public project documentation |

---

**Version**: 1.0.0
**Ratified**: 2025-12-31
**Last Amended**: 2025-12-31
**Phase**: All Phases (I-V)
**Status**: Active

---

**This constitution is the single source of truth for the Evolution of Todo project. All development must comply with these principles and standards.**

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>
